---
title: ""
subtitle: ""
author: ""
institute: ""
output:
  xaringan::moon_reader:
    lib_dir: libs
    yolo: FALSE
---

```{r , echo = FALSE, message = FALSE, warning = FALSE}
# Libraries

library(tidyverse)
library(readr)
library(kableExtra)
library(bookdown)
library(DT)
```

```{r , echo = FALSE, message = FALSE, warning = FALSE}
options(scipen = 200)
Analysis_Data <- read_csv(here::here("Data/Assignment_data.csv"))
```


```{r , echo = FALSE, message = FALSE, warning = FALSE}
data <- Analysis_Data %>%
  filter(Entity %in% c("China","United States")) %>%
  filter(Year>=1970 & Year<=2017) 

data <- data %>%
  rename(Average.annual.hours.worked =
        "Average annual hours worked by persons engaged (avh) (PWT 9.1 (2019))",
        GDP.per.capita="Output-side real GDP per capita (gdppc_o) (PWT 9.1 (2019))",
        Population="Population (historical estimates)",
        Country=Entity) 

two_decimal <- function(x) round(x,2)

 overall <- data %>%
    group_by(Country) %>%
    summarise_at(c("Average.annual.hours.worked","GDP.per.capita","Population"),
                 list(Minimum = ~min(.,na.rm=TRUE), 
                      Median = ~median(.,na.rm=TRUE), 
                      Mean = ~mean(.,na.rm=TRUE))) %>%
    mutate_if(is.numeric,two_decimal) %>% 
    pivot_longer(!Country, names_sep ="_",
                 names_to = c("Variable", ".value"))%>%
   mutate(Variable=ifelse(Variable=="Average.annual.hours.worked",
                          "Hours.worked",Variable))

W1 <-ggplot(data,mapping = aes(x = Year,y=GDP.per.capita,
                           color=Country,group=Country)) +
  geom_line() +
  labs(y ="GDP per capita", 
       caption = "Source: World Bank data base")+
    theme_bw()

W2 <-ggplot(data,mapping = aes(x = Year,y=Average.annual.hours.worked,
                           color=Country,group=Country)) +
  geom_line() +
  labs(y ="Average annual hours worked", 
       caption = "Source: World Bank data base")+
    theme_bw()

W3 <- data %>%
    filter(Country=="United States")%>%
    ggplot(mapping = aes(x = Average.annual.hours.worked,
                          y=GDP.per.capita))+
    geom_point() + 
    stat_smooth(method=lm)+
  labs(x ="Average annual hours worked", 
       y ="GDP per capita", 
       caption = "Source: World Bank data base")+
    theme_bw()
```
---

## Interested Country: China and The United States

<br>
<br>
--
**Q1: How do the Average annual hours worked relates to the GDP between China and The United States
<br>
<br>
--
**Q2: What is the trend of GDP between China and The United States

---

## Descriptive statistical analysis of China and The United States

```{r, echo = FALSE, message = FALSE, warning = FALSE}
datatable(overall)
```

---

## GDP per capita between China and The United States.

```{r,echo = FALSE, warning = FALSE, message = FALSE, fig.align="center",out.width = '80%'}
knitr::include_graphics("figs/Rplot.png")
```

---
## Average annual work hours between China and The United States.

```{r,echo = FALSE, warning = FALSE, message = FALSE, fig.align="center",out.width = '80%'}
knitr::include_graphics("figs/Rplot01.png")
```

---
## The relation between Average annual hours worked and GDP per capita in The United States
```{r,echo = FALSE, warning = FALSE, message = FALSE, fig.align="center",out.width = '80%'}
knitr::include_graphics("figs/Rplot02.png")
```
---
## The relation between Average annual hours worked and GDP per capita in China
```{r,echo = FALSE, warning = FALSE, message = FALSE, fig.align="center",out.width = '80%'}
knitr::include_graphics("figs/Rplot03.png")
```



